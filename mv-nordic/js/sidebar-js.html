<!--
 Copyright 2016-2017 GrammarSoft ApS <info@grammarsoft.com> at https://grammarsoft.com/
 Linguistic backend by Eckhard Bick <eckhard.bick@gmail.com>
 Frontend by Tino Didriksen <mail@tinodidriksen.com>

 This project is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 This project is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with this project.  If not, see <http://www.gnu.org/licenses/>.
-->
<script>
'use strict';

var GS = {
	cache: {},
	};

function getDocument() {
	var hashes = {};
	for (var k in GS.cache) {
		if (!GS.cache.hasOwnProperty(k)) {
			continue;
		}
		hashes[k] = 1;
	}
	google.script.run.withSuccessHandler(gotDocument).withFailureHandler(showError).getDocument(hashes);
}

function gotDocument(doc) {
	for (var i=0 ; i<doc.length ; ++i) {
		GS.cache[doc[i].h] = doc[i];
	}
	console.log(doc);
}

$(function() {
	$('#load').click(getDocument);
});

function showError(msg, element) {
	var div = $('<div id="error" class="error">' + msg + '</div>');
	$(element).after(div);
}
</script>
